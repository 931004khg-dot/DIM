# AutoCAD 치수 스타일 LISP 사용 설명서

## 목차

1. [개요](#개요)
2. [설치 방법](#설치-방법)
3. [사용 방법](#사용-방법)
4. [치수 스타일 설정 상세](#치수-스타일-설정-상세)
5. [문제 해결](#문제-해결)

---

## 개요

이 LISP 프로그램은 AutoCAD에서 ISO-25 규격 기반의 치수 스타일을 자동으로 생성하고 적용할 수 있도록 도와줍니다.

### 주요 특징

- **자동 치수 스타일 생성**: ISO-25 규격에 맞춘 치수 스타일을 자동으로 생성
- **DCL 대화상자**: 사용자 친화적인 인터페이스로 옵션 조정
- **파일 독립적**: 어떤 DWG 파일에서도 LISP만 로드하면 사용 가능
- **템플릿 불필요**: 별도의 템플릿 파일(.dwt) 필요 없음

---

## 설치 방법

### 1. 파일 준비

다음 두 파일을 다운로드하여 같은 폴더에 저장하세요:
- `dimstyle.lsp` (LISP 프로그램)
- `dimstyle.dcl` (대화상자 정의)

**중요**: 두 파일은 반드시 같은 폴더에 있어야 합니다!

### 2. AutoCAD에 로드

#### 방법 1: APPLOAD 사용 (권장)

1. AutoCAD를 실행합니다
2. 명령 프롬프트에 `APPLOAD` 입력 후 Enter
3. `dimstyle.lsp` 파일을 선택
4. "Load" 버튼 클릭
5. 자동 로드를 원하면 "Startup Suite"에 추가

#### 방법 2: 드래그 앤 드롭

1. AutoCAD 창에 `dimstyle.lsp` 파일을 드래그 앤 드롭
2. 확인 메시지가 나타나면 확인

#### 방법 3: 명령줄에서 로드

```
(load "C:/경로/dimstyle.lsp")
```

### 3. 로드 확인

프로그램이 성공적으로 로드되면 다음 메시지가 표시됩니다:

```
========================================
  AutoCAD 치수 스타일 LISP 로드됨
========================================
  명령어: MYDIM
  설명: ISO-25 기반 치수 스타일 생성
========================================
```

---

## 사용 방법

### 1. 기본 사용법

1. 명령 프롬프트에 `MYDIM` 입력 후 Enter
2. DCL 대화상자가 나타납니다
3. 필요한 옵션을 조정합니다
4. "확인" 버튼을 클릭합니다
5. 자동으로 치수 그리기 명령이 실행됩니다

### 2. 대화상자 옵션 설명

#### 기본 설정

- **전체 축척 (DIMSCALE)**: 
  - 기본값: 25
  - 모든 치수 요소의 크기를 조절하는 전체 축척
  - 도면의 축척에 맞춰 조정

- **문자 높이 (DIMTXT)**:
  - 기본값: 2.5
  - 치수 문자의 높이
  - 출력 시 가독성을 고려하여 설정

- **화살표 크기 (DIMASZ)**:
  - 기본값: 2.5
  - 치수선 끝의 화살표 크기

#### 치수보조선 설정

- **간격띄우기 (DIMEXO)**:
  - 기본값: 0.625
  - 치수를 측정하는 객체와 치수보조선 사이의 간격

- **보조선 연장 (DIMEXE)**:
  - 기본값: 1.25
  - 치수선을 넘어 연장되는 치수보조선 길이

#### 문자 설정

- **문자 간격 (DIMGAP)**:
  - 기본값: 0.625
  - 치수 문자와 치수선 사이의 간격

### 3. 치수 그리기

대화상자에서 "확인"을 클릭하면 자동으로 선형 치수(DIMLINEAR) 명령이 실행됩니다.

1. 첫 번째 점을 클릭
2. 두 번째 점을 클릭
3. 치수선 위치를 클릭

다른 치수 명령어도 사용 가능합니다:
- `DIMLINEAR`: 선형 치수
- `DIMALIGNED`: 정렬 치수
- `DIMANGULAR`: 각도 치수
- `DIMRADIUS`: 반지름 치수
- `DIMDIAMETER`: 직경 치수

---

## 치수 스타일 설정 상세

### ISO-25 기본 설정값

프로그램이 생성하는 치수 스타일 "ISO-25-Custom"의 기본 설정:

| 변수 | 값 | 설명 |
|------|-----|------|
| DIMSCALE | 25 | 전체 축척 |
| DIMTXT | 2.5 | 문자 높이 |
| DIMGAP | 0.625 | 문자와 치수선 간격 |
| DIMASZ | 2.5 | 화살표 크기 |
| DIMEXO | 0.625 | 치수보조선 간격띄우기 |
| DIMEXE | 1.25 | 치수보조선 연장 |
| DIMTAD | 1 | 문자를 치수선 위에 배치 |
| DIMTIH | 0 | 문자 항상 수평 |
| DIMTOH | 0 | 문자 항상 수평 |
| DIMDLI | 10.0 | 치수선 간격 |
| DIMUNIT | 2 | 십진법 |
| DIMDEC | 2 | 소수점 이하 2자리 |

### 수동으로 치수 스타일 확인

1. 명령 프롬프트에 `DIMSTYLE` 입력
2. "ISO-25-Custom" 스타일을 확인할 수 있습니다
3. "Modify" 버튼으로 상세 설정 확인 및 수정 가능

---

## 문제 해결

### DCL 파일을 찾을 수 없다는 오류

**문제**: "DCL 대화상자를 로드할 수 없습니다!" 메시지 표시

**해결방법**:
1. `dimstyle.lsp`와 `dimstyle.dcl` 파일이 같은 폴더에 있는지 확인
2. AutoCAD의 지원 파일 검색 경로에 해당 폴더가 포함되어 있는지 확인
   - `OPTIONS` 명령 → `Files` 탭 → `Support File Search Path`에 폴더 추가

### 치수 스타일이 생성되지 않음

**문제**: 명령어 실행 후 치수 스타일이 생성되지 않음

**해결방법**:
1. 명령 프롬프트에서 오류 메시지 확인
2. AutoCAD 버전이 LISP를 지원하는지 확인 (AutoCAD 2000 이상)
3. 다른 도면 파일에서 시도해보기

### 값 입력이 반영되지 않음

**문제**: DCL 대화상자에서 값을 변경했지만 적용되지 않음

**해결방법**:
1. 숫자 값만 입력했는지 확인 (문자 입력 불가)
2. 음수가 아닌 양수 값을 입력했는지 확인
3. 대화상자에서 "확인" 버튼을 눌렀는지 확인

### 다른 도면에서 치수 스타일이 없어짐

**문제**: 새 도면을 열면 치수 스타일이 사라짐

**해결방법**:
- 이것은 정상입니다. 치수 스타일은 도면 파일에 저장됩니다
- 새 도면에서도 `MYDIM` 명령어를 실행하여 치수 스타일을 다시 생성하세요
- 또는 LISP를 자동 로드되도록 설정하여 도면을 열 때마다 자동 실행

---

## 자동 로드 설정 (선택사항)

AutoCAD를 시작할 때마다 자동으로 LISP를 로드하려면:

### 방법 1: Startup Suite 사용

1. `APPLOAD` 명령 실행
2. `Contents` 버튼 클릭 (Startup Suite)
3. `Add` 버튼으로 `dimstyle.lsp` 추가
4. 닫기

### 방법 2: acaddoc.lsp 사용

1. AutoCAD 지원 폴더에 `acaddoc.lsp` 파일 생성
2. 다음 내용 입력:
```lisp
(load "C:/경로/dimstyle.lsp")
```
3. 저장

---

## 추가 기능 요청

더 많은 기능이 필요하시면 다음 사항을 추가할 수 있습니다:

- 여러 개의 사전 정의된 치수 스타일 (ISO-25, ISO-50 등)
- 치수 스타일 가져오기/내보내기 기능
- 배치(Layout) 공간에 맞는 자동 축척 조정
- 단위 변환 기능 (mm, inch 등)
- 한국어/영어 문자 스타일 자동 설정

---

## 버전 정보

- 버전: 1.0
- 최종 수정: 2025-11-03
- 호환: AutoCAD 2000 이상

---

## 라이선스

MIT License - 자유롭게 사용, 수정, 배포 가능
